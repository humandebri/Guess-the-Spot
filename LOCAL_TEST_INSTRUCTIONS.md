# ローカルテスト手順

## 🚀 プロジェクトのローカル起動方法

### 1. DFXローカルネットワークの起動
```bash
# 別のターミナルで実行
dfx start --clean
```

### 2. 既にデプロイ済みのCanister
以下のcanisterは既にデプロイ済みです：
- **reward_mint**: u6s2n-gx777-77774-qaaba-cai
- **photo_nft**: umunu-kh777-77774-qaaca-cai
- **game_engine**: ulvla-h7777-77774-qaacq-cai
- **reputation_oracle**: ucwa4-rx777-77774-qaada-cai

### 3. フロントエンドの起動
```bash
cd src/frontend
npm run dev
```

フロントエンドは以下のURLでアクセス可能：
- http://localhost:3001/

## 🧪 テスト項目

### 1. 認証機能
- [ ] Internet Identityでのログイン
- [ ] Plug Walletでのログイン
- [ ] ログアウト機能

### 2. 写真アップロード機能
- [ ] カメラからの撮影
- [ ] GPS位置情報の取得
- [ ] 方位（azimuth）の取得
- [ ] 写真のアップロード
- [ ] NFTの発行確認

### 3. ゲームプレイ機能
- [ ] ゲームラウンドの開始
- [ ] 写真の表示
- [ ] 地図上でのピン配置
- [ ] 推測の送信
- [ ] スコア計算
- [ ] SPOTトークンの獲得

### 4. その他の機能
- [ ] リーダーボード表示
- [ ] プロフィール表示
- [ ] NFTギャラリー表示
- [ ] ホワイトペーパー表示

## 📝 注意事項

1. **Mapbox APIキー**: 現在はデモキーを使用しているため、地図機能に制限がある可能性があります。

2. **Device Attestation**: SafetyNet/App Attestは現在プレースホルダー実装のため、実際の検証は行われません。

3. **初回データ**: 最初はデータが空なので、まず写真をアップロードしてからゲームをプレイしてください。

## 🔍 デバッグ情報

### Canister URLの確認
```bash
# Candid UIでの確認
open http://127.0.0.1:4943/?canisterId=uzt4z-lp777-77774-qaabq-cai&id=ulvla-h7777-77774-qaacq-cai
```

### ログの確認
```bash
# DFXのログ
dfx canister logs game_engine

# ブラウザのコンソール
# 開発者ツールを開いてConsoleタブを確認
```

## 🎮 プレイ手順

1. **アカウント作成**
   - Internet IdentityまたはPlug Walletでログイン

2. **写真アップロード**
   - Uploadページへ移動
   - カメラで写真を撮影（位置情報と方位を許可）
   - アップロード完了を確認

3. **ゲームプレイ**
   - Gameページへ移動
   - 表示された写真から撮影場所を推測
   - 地図上にピンを配置
   - 推測を送信してスコアを確認

4. **結果確認**
   - 獲得したSPOTトークンを確認
   - リーダーボードで順位を確認
   - プロフィールページで統計を確認

## 🚨 トラブルシューティング

### ログインできない場合
1. DFXが起動していることを確認
2. ブラウザのコンソールでエラーを確認
3. Internet Identityのポップアップがブロックされていないか確認

### 写真がアップロードできない場合
1. カメラと位置情報の権限を確認
2. HTTPSでアクセスしているか確認（位置情報API必須）
3. ファイルサイズが5MB以下か確認

### 地図が表示されない場合
1. Mapbox APIキーが設定されているか確認
2. ネットワーク接続を確認
3. ブラウザの開発者ツールでエラーを確認

お楽しみください！ 🎉